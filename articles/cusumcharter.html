<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>cusumcharter • cusumcharter</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="cusumcharter">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cusumcharter</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/cusumcharter.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/johnmackintosh/cusumcharter/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>cusumcharter</h1>
                        <h4 data-toc-skip class="author">John
MacKintosh</h4>
            
            <h4 data-toc-skip class="date">2024-11-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/johnmackintosh/cusumcharter/blob/master/vignettes/cusumcharter.Rmd" class="external-link"><code>vignettes/cusumcharter.Rmd</code></a></small>
      <div class="hidden name"><code>cusumcharter.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/johnmackintosh/cusumcharter" class="external-link">cusumcharter</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="rationale">Rationale<a class="anchor" aria-label="anchor" href="#rationale"></a>
</h2>
<p>Basic CUSUM statistics are fairly straightforward to construct in a
spreadsheet, if you only need to compare to a target value, or the mean
of your data. However, turning this into a control chart takes a lot
more work, especially if you have several metrics to analyse.</p>
<p>The goal of this package is to allow you to pass simple vectors in,
and receive data back that contains all the information you need to
create faceted CUSUM control charts - (there is also a function that
takes care of this for you).</p>
</div>
<div class="section level2">
<h2 id="a-journey-through-the-package-functions">A journey through the package functions<a class="anchor" aria-label="anchor" href="#a-journey-through-the-package-functions"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">11</span>,<span class="fl">7</span>,<span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">test_vec</span></span>
<span><span class="co">#&gt;  [1]  1  1  2  3  5  7 11  7  5  7  8  9  5</span></span></code></pre></div>
<p>Here is our data, nothing too exciting is it?</p>
<p><em>Or is it?</em></p>
<p>Let’s find out..</p>
</div>
<div class="section level2">
<h2 id="cusum_single">cusum_single<a class="anchor" aria-label="anchor" href="#cusum_single"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">11</span>,<span class="fl">7</span>,<span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">variances</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cusum_single.html">cusum_single</a></span><span class="op">(</span><span class="va">test_vec</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html" class="external-link">qplot</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">variances</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `qplot()` was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="man%2Ffigures%2Fbaseplot-1.png" width="1500"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span></span></code></pre></div>
<p><img src="man%2Ffigures%2Fbaseplot-2.png" width="1500"></p>
<p>This bare bones plot tells us quite a lot. Our measure of interest
started off with small variances, resulting in points below the centre
line at 0, but the variances increased, the points crossed over the
centre line.</p>
</div>
<div class="section level2">
<h2 id="cusum_single_df">cusum_single_df<a class="anchor" aria-label="anchor" href="#cusum_single_df"></a>
</h2>
<p>We input the same vector - this time using the
<code>cusum_single_df</code> function. This returns :</p>
<ul>
<li>our original vector</li>
<li>the target value (if not supplied, the mean is calculated)</li>
<li>the variance of each data point from the target</li>
<li>the cumulative sum of these variances</li>
<li>the cumulative sum of these variances, centred on the target value (
by adding the target to the cumulative sum, i.e. adding
<code>cusum_target</code> to <code>cusumx</code>)</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variance_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cusum_single_df.html">cusum_single_df</a></span><span class="op">(</span><span class="va">test_vec</span><span class="op">)</span></span>
<span><span class="va">variance_df</span></span>
<span><span class="co">#&gt;     x   target         si        cusumx cusum_target</span></span>
<span><span class="co">#&gt; 1   1 5.461538 -4.4615385 -4.461538e+00    1.0000000</span></span>
<span><span class="co">#&gt; 2   1 5.461538 -4.4615385 -8.923077e+00   -3.4615385</span></span>
<span><span class="co">#&gt; 3   2 5.461538 -3.4615385 -1.238462e+01   -6.9230769</span></span>
<span><span class="co">#&gt; 4   3 5.461538 -2.4615385 -1.484615e+01   -9.3846154</span></span>
<span><span class="co">#&gt; 5   5 5.461538 -0.4615385 -1.530769e+01   -9.8461538</span></span>
<span><span class="co">#&gt; 6   7 5.461538  1.5384615 -1.376923e+01   -8.3076923</span></span>
<span><span class="co">#&gt; 7  11 5.461538  5.5384615 -8.230769e+00   -2.7692308</span></span>
<span><span class="co">#&gt; 8   7 5.461538  1.5384615 -6.692308e+00   -1.2307692</span></span>
<span><span class="co">#&gt; 9   5 5.461538 -0.4615385 -7.153846e+00   -1.6923077</span></span>
<span><span class="co">#&gt; 10  7 5.461538  1.5384615 -5.615385e+00   -0.1538462</span></span>
<span><span class="co">#&gt; 11  8 5.461538  2.5384615 -3.076923e+00    2.3846154</span></span>
<span><span class="co">#&gt; 12  9 5.461538  3.5384615  4.615385e-01    5.9230769</span></span>
<span><span class="co">#&gt; 13  5 5.461538 -0.4615385 -1.776357e-15    5.4615385</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html" class="external-link">qplot</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">variance_df</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">variance_df</span><span class="op">$</span><span class="va">target</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="man%2Ffigures%2Fbaseplot2-1.png" width="1500"></p>
</div>
<div class="section level2">
<h2 id="cusum_control">cusum_control<a class="anchor" aria-label="anchor" href="#cusum_control"></a>
</h2>
<p>Here we input the same vector, and receive even more information back
:<br>
- our original vector (x)<br>
- target (supplied or calculated)<br>
- variance of x from target<br>
- std_dev - you can supply a standard deviation (if known), or it is
calculated for you using the screened moving range of x<br>
- cusum is the cumulative sum of the variance<br>
- cplus and cneg depend on the target and <code>k</code> values, and
also relate to the current x value and previous <code>cplus</code> or
<code>cneg</code> value. These are the values that get plotted on the
control chart, hence why you only have to supply an argument for the
<code>x</code> axis.</p>
<p><code>- cum_nplus</code> and <code>cum_nneg</code> are also iterative
values that calculate the number of consecutively rising or declining
points.</p>
<p>- ucl and lcl are derived from the provided <code>h</code> value
(usually between 4 and 5, defaults to 4). This is multiplied by the
<code>std_dev</code> to calculate the upper and lower control limits
(<code>ucl</code> and <code>lcl</code> respectively).</p>
<p>- the centre value is always 0</p>
<p>- obs provides a reference for each value of x, for ease of
plotting.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cs_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cusum_control.html">cusum_control</a></span><span class="op">(</span><span class="va">test_vec</span><span class="op">)</span></span>
<span><span class="co">#&gt; no target value supplied, so using the mean of x</span></span>
<span><span class="va">cs_data</span></span>
<span><span class="co">#&gt;     x   target   variance std_dev         cusum     cplus       cneg cum_nplus</span></span>
<span><span class="co">#&gt; 1   1 5.461538 -4.4615385 1.77305 -4.461538e+00 0.0000000  -3.575014         0</span></span>
<span><span class="co">#&gt; 2   1 5.461538 -4.4615385 1.77305 -8.923077e+00 0.0000000  -7.150027         0</span></span>
<span><span class="co">#&gt; 3   2 5.461538 -3.4615385 1.77305 -1.238462e+01 0.0000000  -9.725041         0</span></span>
<span><span class="co">#&gt; 4   3 5.461538 -2.4615385 1.77305 -1.484615e+01 0.0000000 -11.300055         0</span></span>
<span><span class="co">#&gt; 5   5 5.461538 -0.4615385 1.77305 -1.530769e+01 0.0000000 -10.875068         0</span></span>
<span><span class="co">#&gt; 6   7 5.461538  1.5384615 1.77305 -1.376923e+01 0.6519367  -8.450082         1</span></span>
<span><span class="co">#&gt; 7  11 5.461538  5.5384615 1.77305 -8.230769e+00 5.3038734  -2.025095         2</span></span>
<span><span class="co">#&gt; 8   7 5.461538  1.5384615 1.77305 -6.692308e+00 5.9558101   0.000000         3</span></span>
<span><span class="co">#&gt; 9   5 5.461538 -0.4615385 1.77305 -7.153846e+00 4.6077469   0.000000         4</span></span>
<span><span class="co">#&gt; 10  7 5.461538  1.5384615 1.77305 -5.615385e+00 5.2596836   0.000000         5</span></span>
<span><span class="co">#&gt; 11  8 5.461538  2.5384615 1.77305 -3.076923e+00 6.9116203   0.000000         6</span></span>
<span><span class="co">#&gt; 12  9 5.461538  3.5384615 1.77305  4.615385e-01 9.5635570   0.000000         7</span></span>
<span><span class="co">#&gt; 13  5 5.461538 -0.4615385 1.77305 -1.776357e-15 8.2154937   0.000000         8</span></span>
<span><span class="co">#&gt;    cum_nneg      ucl       lcl centre obs</span></span>
<span><span class="co">#&gt; 1         1 7.092199 -7.092199      0   1</span></span>
<span><span class="co">#&gt; 2         2 7.092199 -7.092199      0   2</span></span>
<span><span class="co">#&gt; 3         3 7.092199 -7.092199      0   3</span></span>
<span><span class="co">#&gt; 4         4 7.092199 -7.092199      0   4</span></span>
<span><span class="co">#&gt; 5         5 7.092199 -7.092199      0   5</span></span>
<span><span class="co">#&gt; 6         6 7.092199 -7.092199      0   6</span></span>
<span><span class="co">#&gt; 7         7 7.092199 -7.092199      0   7</span></span>
<span><span class="co">#&gt; 8         0 7.092199 -7.092199      0   8</span></span>
<span><span class="co">#&gt; 9         0 7.092199 -7.092199      0   9</span></span>
<span><span class="co">#&gt; 10        0 7.092199 -7.092199      0  10</span></span>
<span><span class="co">#&gt; 11        0 7.092199 -7.092199      0  11</span></span>
<span><span class="co">#&gt; 12        0 7.092199 -7.092199      0  12</span></span>
<span><span class="co">#&gt; 13        0 7.092199 -7.092199      0  13</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="cusum_control_plot">cusum_control_plot<a class="anchor" aria-label="anchor" href="#cusum_control_plot"></a>
</h2>
<p><em>The <code>cusum_control</code> function is the most complex and
important function in the package</em></p>
<p>The outputs are not much to look at however, so we harness the power
of <code>ggplot2</code> to enjoy the benefits</p>
<p>If we assume that we don’t want to be outside our upper control
limit, we can see that we now have a problem:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cusum_control_plot.html">cusum_control_plot</a></span><span class="op">(</span><span class="va">cs_data</span>,xvar <span class="op">=</span> <span class="va">obs</span><span class="op">)</span></span></code></pre></div>
<p><img src="man%2Ffigures%2Fcusumcontrolplot-1.png" width="1500"></p>
<p>We can also highlight points below the lower control limit using
<code>show_below</code></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cusum_control_plot.html">cusum_control_plot</a></span><span class="op">(</span><span class="va">cs_data</span>,xvar <span class="op">=</span> <span class="va">obs</span>, show_below <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="man%2Ffigures%2Fcontrolplotshow-1.png" width="1500"></p>
</div>
<div class="section level2">
<h2 id="faceted-displays-and-flexible-x-axis">Faceted displays and flexible x axis<a class="anchor" aria-label="anchor" href="#faceted-displays-and-flexible-x-axis"></a>
</h2>
<p>We can plot many charts at once by using <code>dplyr</code> or
`<code>data.table</code> to group the data</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/johnmackintosh/cusumcharter" class="external-link">cusumcharter</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">testdata</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15L</span>,<span class="fl">2L</span>,<span class="op">-</span><span class="fl">11L</span>,<span class="fl">3L</span>,<span class="fl">1L</span>,<span class="fl">1L</span>,<span class="op">-</span><span class="fl">11L</span>,<span class="fl">1L</span>,<span class="fl">1L</span>,</span>
<span><span class="fl">2L</span>,<span class="fl">1L</span>,<span class="fl">1L</span>,<span class="fl">1L</span>,<span class="fl">10L</span>,<span class="fl">7L</span>,<span class="fl">9L</span>,<span class="fl">11L</span>,<span class="fl">9L</span><span class="op">)</span>,</span>
<span>metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"metric1"</span>,<span class="st">"metric1"</span>,<span class="st">"metric1"</span>,<span class="st">"metric1"</span>,<span class="st">"metric1"</span>,</span>
<span><span class="st">"metric1"</span>,<span class="st">"metric1"</span>,<span class="st">"metric1"</span>,<span class="st">"metric1"</span>,<span class="st">"metric2"</span>,</span>
<span><span class="st">"metric2"</span>,<span class="st">"metric2"</span>,<span class="st">"metric2"</span>,<span class="st">"metric2"</span>,<span class="st">"metric2"</span>,</span>
<span><span class="st">"metric2"</span>,<span class="st">"metric2"</span>,<span class="st">"metric2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">datecol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2021-01-01"</span>,<span class="st">"2021-01-02"</span>, <span class="st">"2021-01-03"</span>, <span class="st">"2021-01-04"</span> ,</span>
<span>             <span class="st">"2021-01-05"</span>, <span class="st">"2021-01-06"</span>,<span class="st">"2021-01-07"</span>, <span class="st">"2021-01-08"</span>,</span>
<span>             <span class="st">"2021-01-09"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">testres</span> <span class="op">&lt;-</span> <span class="va">testdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">metric</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="../reference/cusum_control.html">cusum_control</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">metric</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>report_date <span class="op">=</span> <span class="va">datecol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; no target value supplied, so using the mean of x</span></span>
<span><span class="co">#&gt; no target value supplied, so using the mean of x</span></span>
<span></span>
<span></span>
<span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cusum_control_plot.html">cusum_control_plot</a></span><span class="op">(</span><span class="va">testres</span>,</span>
<span>                         xvar <span class="op">=</span> <span class="va">report_date</span>,</span>
<span>                         show_below <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         facet_var <span class="op">=</span> <span class="va">metric</span>,</span>
<span>                         title_text <span class="op">=</span> <span class="st">"Highlights above and below control limits"</span><span class="op">)</span></span>
<span><span class="va">p5</span></span></code></pre></div>
<p><img src="man%2Ffigures%2Ffacetcontrolplots-1.png" width="1500"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by John MacKintosh.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
